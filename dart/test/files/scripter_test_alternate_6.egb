Title:      Test Gamebook #1  
Subtitle:   The Adventures of a Guy with a Gun  
Author:     Filip Hracek  
            John Doe  
Web:        http://filiph.net/  
Email:      abc@example.com  
Keywords:   crimi, thriller  
Copyright:  Creative Commons  

<classes>
class A {
  int i;
}

// for custom class persistence testing
class ClassWithMapMethods {
  int i;
  String s;
  Map m = const {
    "a": 1,
    "b": 2
  };
  
  toMap() => {"_class": "ClassWithMapMethods", "i": i, "s": s, "m": m};
  
  ClassWithMapMethods();
  
  ClassWithMapMethods.fromMap(map) {
    updateFromMap(map);
  }
  
  updateFromMap(map) {
    i = map["i"];
    s = map["s"];
  }
}
</classes>

---
aaa

Starting. Setting time to 0.

<script>
  time = 0;
</script>

- ABC [bbb]
- CDE [xxx]

---
bbb

Blah.

<variables>
customInstance = new ClassWithMapMethods();
customInstance.i = 10;
customInstance.s = "Hello World";
</variables>

- efger [zzz]
- gegreg [ccc]

---
xxx

Shouldn't reach this!

---
zzz

Shouldn't reach this, neither!

---
ccc

Increasing time by 1 to ${++time}.

Also increasing customInstance.i by one.

<script>
customInstance.i++;
</script>

- egreger [dddeee]
- ervfvcx [zzz]

---
dddeee

Welcome (back?) to dddeee. Time is now $time. customInstance.i is now ${customInstance.i}. Increasing both by 1.

<script>
time++;
customInstance.i++;
</script>

- evdfvdv [fff]
- loop [dddeee]


---
fff

- back [dddeee]
- end [ggg]

---
ggg

End of book.